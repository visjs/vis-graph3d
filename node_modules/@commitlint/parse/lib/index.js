'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});

var _conventionalCommitsParser = require('conventional-commits-parser');

var _conventionalChangelogAngular = require('conventional-changelog-angular');

var _conventionalChangelogAngular2 = _interopRequireDefault(_conventionalChangelogAngular);

var _lodash = require('lodash');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = parse;


function parse(message, parser = _conventionalCommitsParser.sync, parserOpts = undefined) {
	return new Promise(function ($return, $error) {
		var defaultOpts, parsed;
		return Promise.resolve(_conventionalChangelogAngular2.default).then(function ($await_1) {
			try {
				defaultOpts = $await_1.parserOpts;
				parsed = parser(message, (0, _lodash.mergeWith)({}, defaultOpts, parserOpts, (objValue, srcValue) => {
					if ((0, _lodash.isArray)(objValue)) return srcValue;
				}));

				parsed.raw = message;
				return $return(parsed);
			} catch ($boundEx) {
				return $error($boundEx);
			}
		}.bind(this), $error);
	}.bind(this));
}
module.exports = exports['default'];
//# sourceMappingURL=index.js.map